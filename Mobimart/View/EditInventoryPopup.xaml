<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup  xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
		     xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:MobiMart.ViewModel"
             x:DataType="viewmodel:EditInventoryPopupViewModel"
             xmlns:model="clr-namespace:MobiMart.Model"
             x:Class="MobiMart.View.EditInventoryPopup"
             HorizontalOptions="FillAndExpand"
             Margin="0"
             Padding="20">
    
    <VerticalStackLayout Padding="0" Spacing="10" HorizontalOptions="FillAndExpand" Margin="0">
        <Label Text="Select Record for"
               FontSize="18"
               HorizontalOptions="Center"
               FontAttributes="Bold"
               HorizontalTextAlignment="Center"/>
        <Label Text="{Binding Item.Name}"
               FontSize="16"
               HorizontalOptions="Center"/>

        <ScrollView Orientation="Both" HorizontalOptions="Fill" Margin="0">
            <VerticalStackLayout HeightRequest="280" Margin="0">
                <Grid ColumnDefinitions="90,120,120" Padding="5">
                    <Label HorizontalTextAlignment="Center" Grid.Column="0" Text="Quantity"/>
                    <Label HorizontalTextAlignment="Center" Grid.Column="1" Text="Expiry Date"/>
                    <Label HorizontalTextAlignment="Center" Grid.Column="2" Text="Date Delivered"/>
                </Grid>
                <CollectionView ItemsSource="{Binding Deliveries}" HeightRequest="250">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="model:DeliveryRecord">
                            <Grid ColumnDefinitions="90,120,120" Padding="5">
                                <Label Grid.Column="0" HorizontalTextAlignment="Center">
                                    <Label.Text>
                                        <MultiBinding StringFormat="{}{0} / {1}">
                                            <Binding Path="QuantityInStock"/>
                                            <Binding Path="DelivQuantity"/>
                                        </MultiBinding>
                                    </Label.Text>
                                </Label>
                                <Label HorizontalTextAlignment="Center" Grid.Column="1" Text="{Binding DateExpire, StringFormat='{0:d}'}" />
                                <Label HorizontalTextAlignment="Center" Grid.Column="2" Text="{Binding DateDelivered, StringFormat='{0:d}'}" />
                                <Grid.GestureRecognizers>
                                        <TapGestureRecognizer
                                        Tapped="OnTappedRecord"
                                        CommandParameter="{Binding DeliveryId}"/>
                                </Grid.GestureRecognizers>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </ScrollView>

        <Button Text="Close" 
                BackgroundColor="#F6CD5E"
                TextColor="#6D5206"
                Clicked="OnClickedClose"/>
    </VerticalStackLayout>

</toolkit:Popup>