<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:view="clr-namespace:MobiMart.View"
             x:Class="MobiMart.View.ViewTransaction"
             xmlns:viewmodel="clr-namespace:MobiMart.ViewModel"
             x:DataType="viewmodel:ViewTransactionViewModel"
             xmlns:model="clr-namespace:MobiMart.Model"
             BackgroundColor="#FDF4DC"
             Title="ViewTransaction">

    <!-- <Shell.TitleView>
        <Grid ColumnDefinitions="Auto, *">
            <ImageButton
                Grid.Column="0"
                Source="hamburger_icon.png"
                HeightRequest="24"
                WidthRequest="24"
                Clicked="OnHamburgerClicked" />

            <Label
                Grid.ColumnSpan="2"
                Text="MobiMart"
                HorizontalOptions="Center"
                VerticalOptions="Center"
                FontSize="20"
                TextColor="White"
                FontAttributes="Bold" />
        </Grid>
    </Shell.TitleView> -->

    <Grid RowDefinitions="Auto, Auto, Auto, *" Padding="10">

        <!-- Page Header -->
        <Label Grid.Row="0" 
               Text="Transaction Details"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               TextColor="#6D5206"
               FontSize="18"
               FontAttributes="Bold"
               Padding="10"/>

        <!-- Transaction Items List -->
        <Frame Grid.Row="1"
               BackgroundColor="#F6CD5E"
               CornerRadius="10"
               Padding="10"
               Margin="0"
               BorderColor="#6D5206"
               VerticalOptions="FillAndExpand">

            <Grid RowDefinitions="Auto, *" VerticalOptions="FillAndExpand">

                <StackLayout Grid.Row="0" Spacing="10">
                    <Label Text="Transaction List"
                           FontAttributes="Bold"
                           FontSize="16"
                           TextColor="#6D5206"/>
                    <BoxView HeightRequest="1" BackgroundColor="#6D5206" VerticalOptions="End" />
                    <Grid ColumnDefinitions="100, *, *" Padding="0">
                        <Label Text="Item Name" TextColor="#6D5206" FontAttributes="Bold" />
                        <Label Grid.Column="1" Text="Quantity" TextColor="#6D5206" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Grid.Column="2" Text="Price" TextColor="#6D5206" FontAttributes="Bold" HorizontalOptions="Center"/>
                    </Grid>
                    <BoxView HeightRequest="1" BackgroundColor="#6D5206" VerticalOptions="End" />
                </StackLayout>

                <CollectionView Grid.Row="1"
                                Margin="0,5,0,0"
                                ItemsSource="{Binding Record.Items}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="model:SalesItem">
                            <Grid ColumnDefinitions="100, *, *" Padding="5" ColumnSpacing="5">
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 5,5,5,5"
                                        Padding="3">
                                    <Label Text="{Binding Name}" 
                                           TextColor="#6D5206" 
                                           VerticalOptions="Center"/>
                                </Border>
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 5,5,5,5"
                                        Padding="3"
                                        Grid.Column="1">
                                    <Label Text="{Binding Quantity}" 
                                           TextColor="#6D5206" 
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 5,5,5,5"
                                        Padding="3"
                                        Grid.Column="2">
                                    <Label Text="{Binding Price}" 
                                           TextColor="#6D5206" 
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
        </Frame>

        <StackLayout Grid.Row="2"
                     Margin="10,10,0,0"
                     Spacing="5"
                     HorizontalOptions="Start">

            <Label x:Name="TotalLabel"
                   Text="{Binding Record.TotalPrice, StringFormat='Total: ₱{0:F2}'}"
                   FontSize="16"
                   FontAttributes="Bold"
                   TextColor="#6D5206"/>

            <Label x:Name="PaymentLabel"
                   Text="{Binding Record.Payment, StringFormat='Payment: ₱{0:F2}'}"
                   FontSize="16"
                   FontAttributes="Bold"
                   TextColor="#6D5206"/>

            <Label x:Name="ChangeLabel"
                   Text="{Binding Record.Change, StringFormat='Change: ₱{0:F2}'}"
                   FontSize="16"
                   FontAttributes="Bold"
                   TextColor="#6D5206"/>
        </StackLayout>

        <!-- Back Button -->
        <Button Grid.Row="3"
                Text="Back"
                TextColor="#6D5206"
                BackgroundColor="#FBE7B3"
                BorderColor="#6D5206"
                BorderWidth="2"
                CornerRadius="20"
                HeightRequest="40"
                HorizontalOptions="Center"
                VerticalOptions="End"
                WidthRequest="200"
                Margin="0,10,0,10"
                Clicked="OnBackClicked"/>
    </Grid>
</ContentPage>