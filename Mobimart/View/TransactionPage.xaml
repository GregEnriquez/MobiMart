<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:view="clr-namespace:MobiMart.View"
             x:Class="MobiMart.View.TransactionPage"
             BackgroundColor="#FDF4DC"
             Title="TransactionPage">

    <Shell.TitleView>
        <Grid ColumnDefinitions="Auto, *">
            <ImageButton
                Grid.Column="0"
                Source="hamburger_icon.png"
                HeightRequest="24"
                WidthRequest="24"
                Clicked="OnHamburgerClicked" />

            <Label
                Grid.ColumnSpan="2"
                Text="MobiMart"
                HorizontalOptions="Center"
                VerticalOptions="Center"
                FontSize="20"
                TextColor="White"
                FontAttributes="Bold" />
        </Grid>
    </Shell.TitleView>

    <Grid RowDefinitions="Auto, *, Auto, Auto, Auto" Padding="10">

        <Label Grid.Row="0"
               Text="Transaction Page"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               TextColor="#6D5206"
               FontSize="18"
               FontAttributes="Bold"
               Padding="10"/>

        <Frame Grid.Row="1"
               BackgroundColor="#F6CD5E"
               CornerRadius="10"
               Padding="10"
               Margin="0"
               BorderColor="#6D5206"
               VerticalOptions="FillAndExpand">

            <Grid RowDefinitions="Auto, *" VerticalOptions="FillAndExpand">

                <StackLayout Grid.Row="0" Spacing="10">
                    <Label Text="Transaction List"
                           FontAttributes="Bold"
                           FontSize="16"
                           TextColor="#6D5206"/>
                    <BoxView  HeightRequest="1" BackgroundColor="#6D5206" VerticalOptions="End" />
                    <Grid ColumnDefinitions="100, *, *" Padding="0">
                        <Label Text="Item Name" TextColor="#6D5206" FontAttributes="Bold" />
                        <Label Grid.Column="1" Text="Quantity" TextColor="#6D5206" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Grid.Column="2" Text="Price" TextColor="#6D5206" FontAttributes="Bold" HorizontalOptions="Center"/>
                    </Grid>
                    <BoxView  HeightRequest="1" BackgroundColor="#6D5206" VerticalOptions="End" />
                </StackLayout>

                <CollectionView Grid.Row="1"
                                ItemsSource="{Binding Items}"
                                Margin="0,5,0,0">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="100, *, *" Padding="5" ColumnSpacing="5">
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 10,10,10,10">
                                    <Entry Text="{Binding ItemName}" TextColor="#6D5206" Placeholder="Item"/>
                                </Border>
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 10,10,10,10"
                                        Grid.Column="1">
                                    <Entry Text="{Binding Quantity, Mode=TwoWay}" Keyboard="Numeric" WidthRequest="50" HorizontalOptions="Center" TextColor="#6D5206" Placeholder="0"/>
                                </Border>
                                <Border Stroke="#6D5206" 
                                        StrokeThickness="1" 
                                        StrokeShape="RoundRectangle 10,10,10,10"
                                        Grid.Column="2">
                                    <Entry Text="{Binding Price, Mode=TwoWay}" Keyboard="Numeric" WidthRequest="50" HorizontalOptions="Center" TextColor="#6D5206" Placeholder="0"/>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
        </Frame>

        <HorizontalStackLayout Grid.Row="2" Padding="5" HorizontalOptions="Center">
            <Frame Padding="5" HasShadow="False" BackgroundColor="Transparent" BorderColor="Transparent">
                <HorizontalStackLayout Spacing="5" VerticalOptions="Center">
                    <Image Source="add_icon.png" WidthRequest="24" HeightRequest="24"/>
                    <Label Text="Add Item"
                           VerticalOptions="Center"
                           TextColor="#6D5206"
                           FontAttributes="Bold"/>
                </HorizontalStackLayout>

                <Frame.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding AddItemCommand}" />
                </Frame.GestureRecognizers>
            </Frame>
        </HorizontalStackLayout>

        <BoxView  Grid.Row="2" HeightRequest="1" BackgroundColor="#6D5206" VerticalOptions="End" />
        
        <HorizontalStackLayout Grid.Row="3" Padding="15,5" HorizontalOptions="Start">
            <Label Text="Total Price:" FontAttributes="Bold" TextColor="#6D5206"/>
            <Label Text="{Binding TotalPrice}" FontAttributes="Bold" TextColor="#6D5206" Margin="5,0,0,0"/>
        </HorizontalStackLayout>
        
        <HorizontalStackLayout Grid.Row="3" Padding="15,5" HorizontalOptions="Start" Spacing="5">
            <Label Text="Payment:" FontAttributes="Bold" TextColor="#6D5206" VerticalOptions="Center"/>
            <Border Stroke="#6D5206" 
                    StrokeThickness="1" 
                    StrokeShape="RoundRectangle 10,10,10,10"
                    HeightRequest="45"
                    VerticalOptions="Center"
                    Padding="0,0">
                <Entry Text="{Binding Payment, Mode=TwoWay}" 
                   Keyboard="Numeric"
                   Placeholder="0"
                   WidthRequest="50"
                   HeightRequest="30"
                   TextColor="#6D5206"
                   Margin="0,0,0,0"
                   VerticalOptions="Center"/>
            </Border>
        </HorizontalStackLayout>

        <HorizontalStackLayout Grid.Row="3" Padding="15,5" HorizontalOptions="Start" Margin="0,70,0,0">
            <Label Text="Change:" FontAttributes="Bold" TextColor="#6D5206"/>
            <Label Text="{Binding Change}" FontAttributes="Bold" TextColor="#6D5206" Margin="5,0,0,0"/>
        </HorizontalStackLayout>

        <Button Grid.Row="4"
                Command="{Binding SaveTransactionCommand}"
                Text="Save Transaction"
                TextColor="#6D5206"
                BackgroundColor="#FBE7B3"
                BorderColor="#6D5206"
                BorderWidth="2"
                CornerRadius="20"
                HeightRequest="40"
                HorizontalOptions="Center"
                WidthRequest="200"
                Margin="0,10,0,10" />

    </Grid>
</ContentPage>